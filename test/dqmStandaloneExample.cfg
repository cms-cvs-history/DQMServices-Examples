process test={
    
    untracked PSet maxEvents = {untracked int32 input = 2000}
    source = EmptySource {}
    
    # back-end interface service
    service = DaqMonitorROOTBackEnd{}
    
    # MonitorDaemon configuration
    # enable this if you would like to feed info down to a collector
    service = MonitorDaemon {
    # if true, will automatically start DQM thread in background
         untracked bool AutoInstantiate=true
    # if >=0, upon a connection problem, the source will automatically 
    # attempt to reconnect with a time delay (secs) specified here 
    # (default: 5)
         untracked int32 reconnect_delay = 5
    # collector hostname; examples: localhost(default),lxcmse2.cern.ch, etc
         untracked string DestinationAddress = "localhost"
    # port for communicating with collector (default: 9090)
         untracked int32 SendPort = 9090
    # monitoring period in ms (i.e. how often monitoring elements 
    # are shipped to the collector; default: 1000)
         untracked int32 UpdateDelay = 1000
    # maximum # of reconnection attempts upon connection problems (default: 10)
         untracked int32 maxAttempts2Reconnect   = 10
    # name of DQM source (default: DQMSource)
         untracked string NameAsSource = "Example"
    }
    
    # send source _AND_ client histograms out to collector every 5000 events
    service = DQMShipMonitoring{
	// event-period for shipping monitoring to collector (default: 25)
	// untracked uint32 period = 5000
    }
    
    # DQM Source program 
    # code in DQMServices/Daemon/src/DQMSourceExample.cc
    module dqmSource = DQMSourceExample{
	#Determines connection to back-end daemon
	untracked bool MonitorDaemon = true
	       	
	# Verbosity Switch
	untracked bool debug = false

	# set this flag true to disable writing a ROOT output file
	untracked bool disableROOToutput = true

	# Base name for monitor folders and output file		
	untracked string monitorName = "SMExampleSource"

	# Choices for prescaling your module (-1 mean no prescale)
	# Operate every N events
	untracked int32 diagnosticPrescaleEvt = -1
	# Operate every N lumi sections
	untracked int32 diagnosticPrescaleLS  = -1
	# Operate every N minutes
	untracked int32 diagnosticPrescaleTime = -1
	# Operate every N updates
	untracked int32 diagnosticPrescaleUpdate = -1
    }

    # run the quality tests as defined in QualityTests.xml
    module qTester = QualityTester {
	untracked int32 QualityTestPrescaler = 5000
    }

    # DQM Client program
    # code in DQMServices/Examples/src/DQMExampleClient.cc
    # notes:
    # * the prescale is a temporary kludge to avoid call of client on each event
    #   in the next version the EDAnalyzer transition endLuminosityBlock 
    #   should be used
    # * the client performs a fit on h4 every 5000 events
    module dqmClient = DQMClientExample {
	#Determines connection to back-end daemon
	untracked bool MonitorDaemon = true
	       	
	# Verbosity Switch
	untracked bool debug = true

	# set this flag true to disable writing a ROOT output file
	untracked bool disableROOToutput = false

	# Base name for monitor folders and output file		
	untracked string monitorName = "SMExampleClient"

	# Choices for prescaling your module (-1 mean no prescale)
	# Operate every N events
	untracked int32 diagnosticPrescaleEvt = 5000
	# Operate every N lumi sections
	untracked int32 diagnosticPrescaleLS  = -1
	# Operate every N minutes
	untracked int32 diagnosticPrescaleTime = -1
	# Operate every N updates
	untracked int32 diagnosticPrescaleUpdate = -1
    }

    # output into logfiles (verbose)
    service = MessageLogger {
	untracked vstring destinations = { 
	    "detailedInfo" , "critical" , "cout"
	}
	untracked vstring debugModules = { "*" }
	untracked PSet critical     = { untracked string threshold = "ERROR"   }
	untracked PSet detailedInfo = { untracked string threshold = "INFO"    } 
	untracked PSet cout = {
	    untracked string threshold = "WARNING"
	    untracked bool noLineBreaks = true
	    untracked PSet WARNING = {untracked int32 limit = 0 }
	}
    }	
    
    path p ={dqmSource & qTester & dqmClient}

} 
